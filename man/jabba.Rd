% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/jabba-wrapper.R
\name{jabba}
\alias{jabba}
\title{Fit JABBA (Just Another Bayesian Biomass Assessment) Model}
\usage{
jabba(
  catch,
  pr,
  pr.sd = pr/pr * 0.3,
  model = "Pella_m",
  assessment = "",
  scenario = "",
  index = NULL,
  q_bounds = NULL,
  sigma.est = TRUE,
  fixed.obsE = 0.1,
  sigma.proc = TRUE,
  fixed.procE = 0.3,
  igamma = c(3, 0.1),
  q_bound = c(0.001, 1000),
  currentDepletion = "",
  initialDepletion = NA,
  quick = TRUE,
  ...
)
}
\arguments{
\item{catch}{Data.frame with columns \code{year} and \code{catch}. Catch time
series data. Missing or zero values should be replaced with small positive
values (see \code{\link{jabbaData}}).}

\item{pr}{Named vector or data.frame row. Prior parameters containing at
minimum: \code{r} (intrinsic growth rate), \code{psi} (initial depletion),
and \code{shape} (BMSY/B0). May also include \code{k} (carrying capacity)
and \code{current} (current depletion). Typically from \code{\link{jabbaPriors}}.}

\item{pr.sd}{Named vector or data.frame row. Standard deviations for prior
parameters. Must have same names as \code{pr}. Default: 30\% CV for all
parameters (0.3 * pr / pr, which equals 0.3).}

\item{model}{Character string. JABBA model type. Default: \code{"Pella_m"}
(Pella-Tomlinson with estimated shape parameter m). Other options include
\code{"Schaefer"} (m=2), \code{"Fox"} (m=1), etc.}

\item{assessment}{Character string. Assessment name/identifier for output.
Default: \code{""}}

\item{scenario}{Character string. Scenario name/identifier for output.
Default: \code{""}}

\item{index}{Data.frame or matrix. Biomass index (CPUE) data with years as
rows and surveys as columns. First column should be \code{year}. If NULL,
model uses catch-only data. Default: NULL}

\item{q_bounds}{Optional list. Bounds for catchability (q) parameters for
each survey index. Default: NULL (uses \code{q_bound} for all surveys)}

\item{sigma.est}{Logical. Whether to estimate observation error (sigma.obs).
If FALSE, uses \code{fixed.obsE}. Default: TRUE}

\item{fixed.obsE}{Numeric. Fixed observation error standard deviation if
\code{sigma.est = FALSE}. Default: 0.1}

\item{sigma.proc}{Logical. Whether to estimate process error (sigma.proc).
If FALSE, uses \code{fixed.procE}. Default: TRUE}

\item{fixed.procE}{Numeric. Fixed process error standard deviation if
\code{sigma.proc = FALSE}. Default: 0.3}

\item{igamma}{Numeric vector of length 2. Inverse-gamma prior parameters
for process error variance: c(shape, rate). Default: c(3.0, 0.1)}

\item{q_bound}{Numeric vector of length 2. Bounds for catchability (q)
parameters: c(lower, upper). Default: c(1e-3, 1e+3)}

\item{currentDepletion}{Character string. Type of current depletion prior:
\code{"bbmsy"} (B/BMSY) or \code{"ffmsy"} (F/FMSY). If empty string,
no current depletion prior is used. Default: \code{""}}

\item{initialDepletion}{Numeric or NA. Initial depletion value (B0/K).
If NA, uses auxiliary data or defaults. Default: NA}

\item{quick}{Logical. If TRUE, uses quick MCMC settings (fewer iterations).
If FALSE, uses full MCMC. Default: TRUE}

\item{...}{Additional arguments passed to \code{auxFn()} for auxiliary data
(e.g., \code{z}, \code{f}, \code{ffmsy}, \code{effort}, \code{bbmsy}, \code{bk})}
}
\value{
A list with components:
  \itemize{
    \item \code{input}: JABBA input object (from \code{build_jabba})
    \item \code{fit}: JABBA fit object (from \code{fit_jabba}), containing:
      \itemize{
        \item \code{pars_posterior}: Posterior samples of model parameters
        \item \code{refpts_posterior}: Posterior samples of reference points
        \item \code{timeseries}: Time series of biomass, harvest, etc.
        \item \code{kobe}: Kobe plot data (B/BMSY vs F/FMSY)
        \item \code{kbtrj}: Kobe trajectory
      }
  }
  Returns \code{NULL} if \code{build_jabba} fails, or list with only
  \code{input} if \code{fit_jabba} fails.
}
\description{
Fits a JABBA (Just Another Bayesian Biomass Assessment) model to catch and
biomass index data. This is a wrapper function that prepares JABBA inputs
and calls the underlying JABBA fitting functions (\code{build_jabba} and
\code{fit_jabba}).
}
\details{
This function is a wrapper around the JABBA package functions. It:
\itemize{
  \item Prepares prior parameters from \code{pr} and \code{pr.sd}
  \item Sets up model configuration based on \code{model} type
  \item Handles optional auxiliary data (current/initial depletion)
  \item Calls \code{build_jabba()} to create JABBA input object
  \item Calls \code{fit_jabba()} to fit the model via MCMC
}

The Pella-Tomlinson production function is used by default, which allows
the shape parameter (m) to be estimated. This provides flexibility in
modeling different stock production dynamics.
}
\examples{
\dontrun{
# Prepare data and priors
data <- jabbaData("cod.27.47d20", icesdata)
priors <- jabbaPriors(icesdata)
pr <- priors[priors$.id == "cod.27.47d20", ]

# Fit JABBA model
fit <- jabba(catch = data[, c("year", "catch")],
             pr = pr,
             index = data[, c("year", "index")],
             scenario = "EBiomass",
             assessment = "cod.27.47d20")

# Extract results
results <- jabbaExtract(fit)
}

}
\seealso{
\code{\link{jabbaPriors}}, \code{\link{jabbaData}}, \code{\link{jabbaExtract}},
\code{\link{jabbaDiagnostics}}, \code{\link{jabbaPE}}
}
