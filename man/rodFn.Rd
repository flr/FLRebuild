% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/stars.R
\name{rodFn}
\alias{rodFn}
\title{Detect Regime Shifts in Time Series Data}
\usage{
rodFn(data, year = NULL, n = 10, sig = 1.68, plot = FALSE)
}
\arguments{
\item{data}{Numeric vector of time series data to analyze}

\item{year}{Optional numeric vector of years corresponding to data points.
If NULL (default), years are set to sequential indices (1, 2, 3, ...)}

\item{n}{Numeric. Minimum assumed regime length (default: 10). The algorithm
requires at least this many observations to identify a regime.}

\item{sig}{Numeric. Significance level based on t-distribution (default: 1.68).
This significance level is roughly equal to p < 0.1. Note: ideally this
should be based on an appropriate t-distribution given the number of
observations in the series, but this is not currently implemented.}

\item{plot}{Logical. If TRUE, plots the time series with regime polygons
overlaid (default: FALSE)}
}
\value{
A data.frame with columns:
  \item{regime}{Factor identifying the regime number}
  \item{data}{Numeric values for plotting regime polygons (mean Â± SD)}
  \item{year}{Numeric year values corresponding to regime boundaries}
}
\description{
Detects regime shifts in a time series using a modified Sequential T-test
Algorithm for Regime Shifts (STARS; Rodionov 2004). This implementation
differs from the original STARS algorithm in that when a new regime is
detected, the algorithm begins searching at n+regimeLength (where n is the
first year of the regime identified), rather than n+1 as in the original.
Additionally, a 'Huber parameter' (which adjusts the influence of outliers)
is not included in this version.
}
\details{
The function iteratively identifies regime shifts in the time series:
\enumerate{
  \item Identifies the first regime shift using \code{ROregimeSHFT()}
  \item Continues searching for subsequent shifts starting from the end
    of the previous regime plus the minimum regime length
  \item Calculates mean and standard deviation for each identified regime
  \item Returns a data frame suitable for plotting regime polygons
}

The returned data frame is structured for use with ggplot2, where each
regime is represented as a polygon with vertices at (minyear, mean+sd),
(minyear, mean-sd), (maxyear, mean-sd), (maxyear, mean+sd).
}
\examples{
\dontrun{
# Create example time series with regime shifts
set.seed(123)
val <- c(rnorm(12, 0, 0.5), rnorm(12, 1, 0.5), rnorm(12, 0, 0.5))
years <- 1980:(1980 + length(val) - 1)

# Detect regime shifts
regimes <- rodFn(val, year = years, n = 10, plot = TRUE)

# Plot with ggplot2
library(ggplot2)
df <- data.frame(year = years, data = val)
ggplot(df, aes(x = year, y = data)) +
  geom_polygon(aes(year, data, group = regime),
               fill = "lavender", col = "blue",
               lwd = 0.25, data = regimes, alpha = 0.75) +
  geom_point() +
  geom_line()
}

}
\references{
Rodionov, S. N. (2004). A sequential algorithm for testing climate regime
shifts. Geophysical Research Letters, 31(9), L09204.
}
\seealso{
\code{\link{rod}} for FLQuant method, \code{\link{ROregimeSHFT}}
  for the internal shift detection algorithm
}
